<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Linux CTF — Day 1</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:system-ui,Arial;margin:24px;max-width:900px}
.card{border:1px solid #ddd;border-radius:14px;padding:16px;margin:16px 0}
.locked{opacity:.45}
input{width:100%;padding:10px;margin-top:8px;border-radius:10px;border:1px solid #ccc}
button{padding:10px 14px;margin-top:10px;border-radius:10px;border:1px solid #ccc;cursor:pointer}
.ok{color:#1b7f2a;font-weight:700}
.no{color:#b00020;font-weight:700}
small{color:#444}
</style>
</head>
<body>

<h1>Linux CTF — Day 1</h1>
<p>
Open <b>WebVM</b> in another tab.  
Run the setup script your teacher provides.  
Solve each mission using Linux commands.
</p>

<div id="progress"></div>
<div id="missions"></div>

<script>
const STORAGE_KEY = "linux_ctf_day1_v1";

const missions = [
 {title:"1) Hidden Reality", hash:"9a6a6f82b33b0b6a0f15d3f44e3dbd75c09d5d1a2a6b91c63f9d4c93c3e98f15",
  text:"How many hidden files exist? Multiply by 11.",
  hint:"Hidden files start with a dot."},

 {title:"2) Deep Inside", hash:"f1c1a2f0b9b1c51dbdd07f26db3c1c8c1d8a3ed08e0c2f9f1e2f2a6f1c12a947",
  text:"Count directory levels to reach the deepest file.",
  hint:"Each folder counts as one level."},

 {title:"3) Word Hunter", hash:"4b35a94f8f49ef9d2871a0cf6a90f6f0bb9b7f6bba70df1f94c34f2b20c35e91",
  text:"How many files contain the word 'linux'?",
  hint:"Search file contents, not filenames."},

 {title:"4) Size Matters", hash:"f43db1f6c42b86a4d8bfa95b1cc4c59e243dbe4c78a6e36bb0a60df93a6c8e2a",
  text:"Find the largest file (bytes). Use that number.",
  hint:"Long listing shows sizes."},

 {title:"5) Permission Puzzle", hash:"3b4e8cdd79b5ff3dcd86c90aaf7d94bcbdf96e29b9f22d53a8a8b7c89dbf5b41",
  text:"How many files are NOT readable?",
  hint:"Look at r/w/x bits."},

 {title:"6) Dash Trap", hash:"d5b56f1cf9f6e8f7a0a0cb6fa3f6f7b6b18d95d7f2b9e90f0d86a1c5d6f2e1c1",
  text:"Count characters in the file with a tricky name.",
  hint:"Files starting with '-' need special handling."},

 {title:"7) User Count", hash:"b28c74ed0c1f9c4a6df8f34d27c8f7e9b7b36b0a4f9f72dfd8f3d1a6f59b8a3c",
  text:"How many logged-in users?",
  hint:"There is a command for that."},

 {title:"8) Line Numbers", hash:"e6f2f31f47d83f2a0cf65b42bfb6f8f5f1d8a0b35c7e2f1c8f2e1a9b7d8f9c3a",
  text:"How many lines are in the log file?",
  hint:"Count lines, not words."},

 {title:"9) Environment Spy", hash:"bb3b6f6d2e0a94f5c2c71f7f4f5b4b7a6c3f2e1a9d8b7c6f5e4d3c2b1a09f8e7d",
  text:"Length of the SECRET variable's value.",
  hint:"Environment variables live in memory."},

 {title:"10) Final Calculation", hash:"8f6e2b4c9d3a1e7f5c0b2a9e1d4f8c7a6b5e9d3f2a1c0b7e6d5f4a9b8c7d6e5f",
  text:"Add results from missions 1, 3, and 8.",
  hint:"CTFs reward good notes."}
];

async function sha256(str){
 const buf = await crypto.subtle.digest("SHA-256", new TextEncoder().encode(str));
 return [...new Uint8Array(buf)].map(b=>b.toString(16).padStart(2,"0")).join("");
}

let solved = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");

function render(){
 document.getElementById("progress").innerHTML =
 `<p><b>Progress:</b> ${solved.length}/${missions.length}</p>`;

 const mdiv = document.getElementById("missions");
 mdiv.innerHTML = "";

 missions.forEach((m,i)=>{
  const unlocked = i===0 || solved.includes(i-1);
  const done = solved.includes(i);

  const d = document.createElement("div");
  d.className = "card " + (unlocked?"":"locked");
  d.innerHTML = `
   <h3>${m.title} ${done?"✔":""}</h3>
   <p>${m.text}</p>
   <small>Hint: ${m.hint}</small>
   ${unlocked?`
    <input id="i${i}" placeholder="FLAG{number}">
    <button onclick="check(${i})">Submit</button>
    <div id="m${i}"></div>
   `:"<p><i>Locked</i></p>"}
  `;
  mdiv.appendChild(d);
 });
}

async function check(i){
 const input = document.getElementById("i"+i).value.trim();
 const msg = document.getElementById("m"+i);
 const h = await sha256(input);
 if(h === missions[i].hash){
  if(!solved.includes(i)) solved.push(i);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(solved));
  msg.innerHTML = "<span class='ok'>Correct</span>";
  render();
 } else {
  msg.innerHTML = "<span class='no'>Incorrect</span>";
 }
}

render();
</script>
</body>
</html>
