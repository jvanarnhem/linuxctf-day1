<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Linux CTF — Day 1</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Arial,sans-serif;margin:24px;max-width:980px}
    .topbar{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-bottom:14px}
    .pill{border:1px solid #ddd;border-radius:999px;padding:8px 12px}
    .btn{border:1px solid #ccc;border-radius:12px;padding:10px 14px;cursor:pointer;background:#fff}
    .btn:hover{background:#f6f6f6}
    .card{border:1px solid #ddd;border-radius:16px;padding:16px;margin:14px 0}
    .locked{opacity:.45}
    input{width:100%;padding:10px;border-radius:12px;border:1px solid #ccc;margin-top:10px}
    .ok{color:#1b7f2a;font-weight:700}
    .no{color:#b00020;font-weight:700}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-top:10px}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
  </style>
</head>
<body>

  <h1>Linux CTF — Day 1</h1>
  <div class="topbar">
    <div class="pill"><b>Format:</b> <span class="mono">FLAG{...}</span></div>
    <div class="pill" id="progressPill"><b>Progress:</b> 0/10</div>
    <button class="btn" id="resetBtn" type="button">Reset Progress</button>
  </div>

  <div id="missions"></div>

  <script>
    const STORAGE_KEY = "linux_ctf_day1_flags_v2";

    const missions = [
      { title: "1) Hide and Seek",
        text: "Find the hidden flag file. Submit the flag.",
        hash: "01779c701cd26fc7e4491720764fe279ae798d8767e1aa6bd3221516e2ab1fa5"
      },
      { title: "2) A(Mazing)",
        text: "Navigate the maze and locate the flag at the end.",
        hash: "d779818717443a957f3a030e32101b347d1caab272ffe51c1b42a870d318f35b"
      },
      { title: "3) My Friend Grep",
        text: "Use grep to locate the flag hidden inside text files.",
        hash: "a2899d68d265e34b6b2b183280563b2306cd65db48fd68089bbe78bee40e05ee"
      },
      { title: "4) Finders Keepers, Losers Weepers",
        text: "Use find to locate the specific key file with the flag inside.",
        hash: "8ea823f563b547c56487f462ed4492ba00a268d632c261b02735d7e4fcd53136"
      },
      { title: "5) Dasher",
        text: "A file name starts with a dash. Read it and submit the flag.",
        hash: "c3eb06d9d1fe7b7da960c7b180113f6d4a336a266069cd9c6aeedf4fa89f5078"
      },
      { title: "6) Change the Mode",
        text: "A flag is locked by permissions. Fix access and submit the flag.",
        hash: "3b18d346a960f95cb9ab6f2e6c4217637c2516f41e46d9ed68def4380efc62ba"
      },
      { title: "7) Encoded",
        text: "A flag is base64-encoded. Decode it and submit the flag.",
        hash: "22b6e7bb243562d6a540e6858c408c801f2eaa13ee8c1c0213cb82974c70f8c2"
      },
      { title: "8) That is a LOT of Text",
        text: "A big log hides the flag near the end. Retrieve it and submit the flag.",
        hash: "209a2787c9fdf663ce67d3526b76bb7e3425dd6727a3f3f05ec24c531fe2a896"
      },
      { title: "9) 1s and 0s",
        text: "A binary file hides a flag. Extract it and submit the flag.",
        hash: "8e6bf94032f4a2c9d48de2c1701c110a5e2002d4deb5a099d00c9973cf8113a1"
      },
      { title: "10) Vault to the End",
        text: "Search the vault to locate the final flag and submit it.",
        hash: "9c0ed3f22c8f8a3a2307aae92e8632d0907b9bdc5c63ec2e90b41d47db6c9871"
      }
    ];

    async function sha256(str){
      const buf = await crypto.subtle.digest("SHA-256", new TextEncoder().encode(str));
      return [...new Uint8Array(buf)].map(b => b.toString(16).padStart(2,"0")).join("");
    }

    function loadSolved(){
      try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]"); }
      catch { return []; }
    }

    function saveSolved(arr){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
    }

    function setProgressPill(solvedCount){
      document.getElementById("progressPill").innerHTML = `<b>Progress:</b> ${solvedCount}/10`;
    }

    function render(){
      const solved = loadSolved();
      setProgressPill(solved.length);

      const wrap = document.getElementById("missions");
      wrap.innerHTML = "";

      missions.forEach((m, i) => {
        const unlocked = (i === 0) || solved.includes(i - 1);
        const done = solved.includes(i);

        const card = document.createElement("div");
        card.className = "card " + (unlocked ? "" : "locked");

        card.innerHTML = `
          <h3>${m.title} ${done ? '<span class="ok">✔</span>' : ''}</h3>
          <p>${m.text}</p>
          ${
            unlocked ? `
              <input id="in_${i}" class="mono" placeholder="FLAG{...}" ${done ? "disabled" : ""} />
              <div class="row">
                <button class="btn" type="button" ${done ? "disabled" : ""} onclick="check(${i})">Submit</button>
                <div id="msg_${i}"></div>
              </div>
            ` : `<p><i>Locked</i></p>`
          }
        `;

        wrap.appendChild(card);
      });
    }

    async function check(i){
      const solved = loadSolved();
      const inputEl = document.getElementById("in_" + i);
      const msgEl = document.getElementById("msg_" + i);
      const val = (inputEl.value || "").trim();

      if(!/^FLAG\{[A-Za-z0-9_-]+\}$/.test(val)){
        msgEl.innerHTML = `<span class="no">Invalid format</span>`;
        return;
      }

      const h = await sha256(val);
      if(h === missions[i].hash){
        if(!solved.includes(i)) solved.push(i);
        saveSolved(solved);
        msgEl.innerHTML = `<span class="ok">Correct</span>`;
        render();
      } else {
        msgEl.innerHTML = `<span class="no">Incorrect</span>`;
      }
    }

    window.check = check;

    document.getElementById("resetBtn").addEventListener("click", () => {
      localStorage.removeItem(STORAGE_KEY);
      render();
    });

    render();
  </script>
</body>
</html>
